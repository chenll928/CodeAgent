# AI ç¼–ç  Agent è®¾è®¡æ–¹æ¡ˆ

## ä¸€ã€æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI ç¼–ç  Agent æ ¸å¿ƒå±‚                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  éœ€æ±‚ç†è§£æ¨¡å—          ä¸Šä¸‹æ–‡ç®¡ç†å™¨          ä»£ç ç”Ÿæˆæ¨¡å—      â”‚
â”‚  ğŸ¤– LLM è°ƒç”¨          âœ… æ—  LLM            ğŸ¤– LLM è°ƒç”¨       â”‚
â”‚  - éœ€æ±‚è§£æ           - è°ƒç”¨é“¾è¿½è¸ª          - ä»£ç å®ç°        â”‚
â”‚  - åŠŸèƒ½è®¾è®¡           - Tokenä¼˜åŒ–          - ä»£ç ä¿®æ”¹        â”‚
â”‚  - ä»»åŠ¡åˆ†è§£           - ç²¾å‡†å®šä½            - æµ‹è¯•ç”Ÿæˆ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              å¢å¼ºçš„ CodebaseAgent (æ‰©å±• IntentGraph)          â”‚
â”‚  - è°ƒç”¨é“¾è¿½è¸ª  - å½±å“åˆ†æ  - æ¶æ„ç†è§£  - éœ€æ±‚æ˜ å°„            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   IntentGraph æ ¸å¿ƒå¼•æ“                        â”‚
â”‚  - å‡½æ•°çº§ä¾èµ–å›¾  - ç¬¦å·åˆ†æ  - è¯­ä¹‰åˆ†æ  - æ™ºèƒ½èšç±»          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## äºŒã€æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. éœ€æ±‚ç†è§£æ¨¡å— (RequirementAnalyzer)

**èŒè´£**: è§£æéœ€æ±‚ â†’ ç”Ÿæˆè®¾è®¡ â†’ åˆ†è§£ä»»åŠ¡

```python
class RequirementAnalyzer:
    def analyze_requirement(self, requirement: str) -> RequirementAnalysis:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 1: éœ€æ±‚è§£æ (~2KB Token)"""
        # è¾“å…¥: éœ€æ±‚æ–‡æœ¬ + æ¶æ„æ‘˜è¦
        # è¾“å‡º: éœ€æ±‚ç±»å‹ã€å½±å“èŒƒå›´ã€å…³é”®å®ä½“

    def design_solution(self, analysis: RequirementAnalysis) -> DesignPlan:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 2: åŠŸèƒ½è®¾è®¡ (~5KB Token)"""
        # è¾“å…¥: éœ€æ±‚åˆ†æ + ç›¸ä¼¼æ¨¡å¼ + æ¥å£å®šä¹‰
        # è¾“å‡º: æŠ€æœ¯æ–¹æ¡ˆã€æ¥å£è®¾è®¡ã€å®ç°æ­¥éª¤

    def decompose_tasks(self, design: DesignPlan) -> List[Task]:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 3: ä»»åŠ¡åˆ†è§£ (~3KB Token)"""
        # è¾“å…¥: è®¾è®¡æ–¹æ¡ˆ + ä¾èµ–å›¾
        # è¾“å‡º: å¯æ‰§è¡Œä»»åŠ¡åˆ—è¡¨ã€ä¾èµ–å…³ç³»ã€ä¼˜å…ˆçº§
```

### 2. ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (ContextManager)

**èŒè´£**: ç²¾å‡†ä¸Šä¸‹æ–‡æå– + Token ä¼˜åŒ– (æ—  LLM è°ƒç”¨)

```python
class ContextManager:
    def trace_call_chain(self, symbol: str, depth: int = 3) -> CallChain:
        """è¿½è¸ªè°ƒç”¨é“¾ (åŸºäº IntentGraph ä¾èµ–å›¾)"""
        # ä¸Šæ¸¸: è°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°
        # ä¸‹æ¸¸: è¿™ä¸ªå‡½æ•°è°ƒç”¨äº†è°
        # è¿”å›: å®Œæ•´è°ƒç”¨è·¯å¾„ + è¡Œå·

    def extract_precise_context(
        self,
        target: str,
        token_budget: int
    ) -> PreciseContext:
        """æå–ç²¾å‡†ä¸Šä¸‹æ–‡ (åˆ†å±‚åŠ è½½)"""
        # Layer 1 (1KB): ç›®æ ‡ä»£ç  + ç­¾å
        # Layer 2 (2KB): + ç›´æ¥ä¾èµ–
        # Layer 3 (3KB): + è°ƒç”¨é“¾
        # Layer 4 (4KB): + ç›¸ä¼¼æ¨¡å¼

    def analyze_impact(self, change: CodeChange) -> ImpactAnalysis:
        """åˆ†æå˜æ›´å½±å“ (åŸºäºä¾èµ–å›¾ç®—æ³•)"""
        # ç›´æ¥å½±å“: è°ƒç”¨è€…ã€è¢«è°ƒç”¨è€…
        # é—´æ¥å½±å“: ä¼ é€’ä¾èµ–
        # é£é™©è¯„ä¼°: ç ´åæ€§å˜æ›´æ£€æµ‹

    def compress_context(self, context: dict, target_size: int) -> dict:
        """æ™ºèƒ½å‹ç¼©ä¸Šä¸‹æ–‡"""
        # 1. ç§»é™¤æ³¨é‡Šå’Œæ–‡æ¡£
        # 2. å‹ç¼©ç©ºç™½å­—ç¬¦
        # 3. åªä¿ç•™å‡½æ•°ç­¾å
        # 4. ä½¿ç”¨ç¬¦å·å¼•ç”¨
```

### 3. ä»£ç ç”Ÿæˆæ¨¡å— (CodeGenerator)

**èŒè´£**: ç”Ÿæˆ/ä¿®æ”¹ä»£ç  + ç”Ÿæˆæµ‹è¯•

```python
class CodeGenerator:
    def implement_new_feature(
        self,
        design: DesignPlan,
        context: PreciseContext
    ) -> CodeImplementation:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 4: æ–°åŠŸèƒ½å®ç° (~4KB Token)"""
        # è¾“å…¥: è®¾è®¡æ–¹æ¡ˆ + ç²¾å‡†ä¸Šä¸‹æ–‡
        # è¾“å‡º: æ–°ä»£ç  + é›†æˆç‚¹

    def modify_existing_code(
        self,
        target: str,
        modification: Modification,
        context: PreciseContext
    ) -> CodeChange:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 5: å­˜é‡ä¿®æ”¹ (~6KB Token)"""
        # è¾“å…¥: ç›®æ ‡ä»£ç  + è°ƒç”¨é“¾ + å½±å“åˆ†æ
        # è¾“å‡º: ä¿®æ”¹åä»£ç  + è¿ç§»æŒ‡å—

    def generate_tests(self, implementation: CodeImplementation) -> TestSuite:
        """ğŸ¤– LLM è°ƒç”¨ç‚¹ 6: æµ‹è¯•ç”Ÿæˆ (~3KB Token)"""
        # è¾“å…¥: å®ç°ä»£ç  + æ¥å£å®šä¹‰
        # è¾“å‡º: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•
```

### 4. å¢å¼ºçš„ CodebaseAgent (æ‰©å±• IntentGraph)

**èŒè´£**: æä¾›ç»“æ„åŒ–æŸ¥è¯¢èƒ½åŠ› (å¤§éƒ¨åˆ†æ—  LLM)

```python
class EnhancedCodebaseAgent(CodebaseAgent):
    # ===== è°ƒç”¨é“¾è¿½è¸ª (æ—  LLM) =====
    def get_call_chain(self, symbol: str, direction: str, max_depth: int):
        """è·å–å®Œæ•´è°ƒç”¨é“¾"""

    def find_entry_points(self, symbol: str) -> List[EntryPoint]:
        """æŸ¥æ‰¾å…¥å£ç‚¹ (æœ€ä¸Šæ¸¸)"""

    def find_leaf_dependencies(self, symbol: str) -> List[Dependency]:
        """æŸ¥æ‰¾å¶å­ä¾èµ– (æœ€ä¸‹æ¸¸)"""

    # ===== æ¶æ„ç†è§£ (æ—  LLM) =====
    def understand_architecture(self) -> ArchitectureMap:
        """ç†è§£æ•´ä½“æ¶æ„ (åŸºäºè¯­ä¹‰åˆ†æ)"""

    def get_module_boundaries(self) -> ModuleBoundaries:
        """è·å–æ¨¡å—è¾¹ç•Œå’Œæ¥å£"""

    # ===== ç²¾å‡†å®šä½ (æ··åˆæ¨¡å¼) =====
    def locate_implementation(self, feature: str) -> List[CodeLocation]:
        """å®šä½å®ç° (ç»“æ„åŒ–æŸ¥è¯¢: æ—  LLM, è¯­ä¹‰æŸ¥è¯¢: ğŸ¤– LLM)"""

    def find_similar_patterns(self, pattern: str) -> List[PatternMatch]:
        """æŸ¥æ‰¾ç›¸ä¼¼æ¨¡å¼ (åŸºäºè¯­ä¹‰åˆ†æ + ç›¸å…³æ€§æ’åº)"""

    # ===== Token ä¼˜åŒ– (æ—  LLM) =====
    def get_minimal_context(
        self,
        target: str,
        task_type: str,
        token_budget: int
    ) -> MinimalContext:
        """è·å–æœ€å°åŒ–ä¸Šä¸‹æ–‡"""
```
## ä¸‰ã€å·¥ä½œæµç¨‹

### åœºæ™¯ 1: æ–°å¢åŠŸèƒ½å®ç°

```
ç”¨æˆ·éœ€æ±‚: "æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œæ”¯æŒé‚®ç®±å’Œæ‰‹æœºå·ç™»å½•"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 1: éœ€æ±‚ç†è§£                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RequirementAnalyzer.analyze_requirement()                   â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~2KB):                                          â”‚
â”‚   - éœ€æ±‚æ–‡æœ¬: "æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½..."                           â”‚
â”‚   - æ¶æ„æ‘˜è¦: {layers, modules, patterns}                    â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - ç±»å‹: new_feature                                        â”‚
â”‚   - èŒƒå›´: [domain/auth, api/user_routes]                    â”‚
â”‚   - å®ä½“: [User, AuthService, LoginCredential]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 2: åŠŸèƒ½è®¾è®¡                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RequirementAnalyzer.design_solution()                       â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~5KB):                                          â”‚
â”‚   - éœ€æ±‚åˆ†æç»“æœ                                              â”‚
â”‚   - ç›¸ä¼¼æ¨¡å¼: [User.authenticate å®ç°]                       â”‚
â”‚   - æ¥å£å®šä¹‰: [User å…¬å…±æ–¹æ³•, ä¾èµ–æ¥å£]                      â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - æ–°ç±»: AuthService, LoginCredential                       â”‚
â”‚   - æ–°æ–¹æ³•: login_with_email, login_with_phone              â”‚
â”‚   - é›†æˆç‚¹: User.authenticate, API.post_login               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 3: ä»»åŠ¡åˆ†è§£                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RequirementAnalyzer.decompose_tasks()                       â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~3KB):                                          â”‚
â”‚   - è®¾è®¡æ–¹æ¡ˆ                                                  â”‚
â”‚   - ä¾èµ–å›¾: {User â†’ Database, API â†’ User}                   â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   1. åˆ›å»º auth_service.py                                    â”‚
â”‚   2. å®ç°ç™»å½•é€»è¾‘                                             â”‚
â”‚   3. æ›´æ–° User æ¨¡å‹                                           â”‚
â”‚   4. æ·»åŠ  API ç«¯ç‚¹                                            â”‚
â”‚   5. ç¼–å†™æµ‹è¯•                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 4: è·å–ç²¾å‡†ä¸Šä¸‹æ–‡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ContextManager.extract_precise_context()                    â”‚
â”‚ âœ… æ—  LLM (åŸºäº IntentGraph):                                â”‚
â”‚   - User ç±»å®šä¹‰ (1KB)                                        â”‚
â”‚   - ç›¸å…³æ¥å£: Database, EmailService (1KB)                  â”‚
â”‚   - ç›¸ä¼¼å®ç°: User.authenticate (1KB)                        â”‚
â”‚   - ä»£ç é£æ ¼: type_hints, docstring_style (0.5KB)           â”‚
â”‚                                                              â”‚
â”‚ æ€»è®¡: ~3.5KB                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 5: ä»£ç ç”Ÿæˆ                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CodeGenerator.implement_new_feature()                       â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~4KB):                                          â”‚
â”‚   - ä»»åŠ¡: "å®ç° AuthService.login_with_email()"              â”‚
â”‚   - ç²¾å‡†ä¸Šä¸‹æ–‡ (3.5KB)                                       â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - src/domain/auth_service.py (æ–°æ–‡ä»¶)                     â”‚
â”‚   - æ›´æ–° src/domain/user.py                                 â”‚
â”‚   - æ›´æ–° src/api/user_routes.py                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 6: æµ‹è¯•ç”Ÿæˆ                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CodeGenerator.generate_tests()                              â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~3KB):                                          â”‚
â”‚   - å®ç°ä»£ç                                                   â”‚
â”‚   - æ¥å£å®šä¹‰                                                  â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - tests/test_auth_service.py                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ€» Token æ¶ˆè€—: ~17KB
```

### åœºæ™¯ 2: ä¿®æ”¹å­˜é‡ä»£ç 

```
ç”¨æˆ·éœ€æ±‚: "ä¿®æ”¹ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼Œæ·»åŠ é‚®ç®±éªŒè¯æ­¥éª¤"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 1: éœ€æ±‚ç†è§£                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RequirementAnalyzer.analyze_requirement()                   â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~2KB)                                           â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - ç±»å‹: modify_existing                                    â”‚
â”‚   - ç›®æ ‡: User.register()                                    â”‚
â”‚   - å˜æ›´: æ·»åŠ é‚®ç®±éªŒè¯é€»è¾‘                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 2: ç²¾å‡†å®šä½                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EnhancedCodebaseAgent.locate_implementation()               â”‚
â”‚ âœ… æ—  LLM (åŸºäºç¬¦å·ç´¢å¼•):                                     â”‚
â”‚   - å®šä½: src/domain/user.py::register (line 45-67)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 3: è°ƒç”¨é“¾è¿½è¸ª                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ContextManager.trace_call_chain()                           â”‚
â”‚ âœ… æ—  LLM (åŸºäºä¾èµ–å›¾):                                       â”‚
â”‚   - ä¸Šæ¸¸: api/user_routes.py::create_user (line 23)        â”‚
â”‚   - ä¸‹æ¸¸: register â†’ hash_password â†’ db.save                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 4: å½±å“åˆ†æ                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ContextManager.analyze_impact()                             â”‚
â”‚ âœ… æ—  LLM (åŸºäºå›¾ç®—æ³•):                                       â”‚
â”‚   - ç›´æ¥å½±å“: api/user_routes.py::create_user              â”‚
â”‚   - æµ‹è¯•æ–‡ä»¶: tests/test_user.py::test_register            â”‚
â”‚   - é£é™©: ä¸­ç­‰ (éœ€è¦æ›´æ–°è°ƒç”¨æ–¹)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 5: æå–ç²¾å‡†ä¸Šä¸‹æ–‡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ContextManager.extract_precise_context()                    â”‚
â”‚ âœ… æ—  LLM:                                                    â”‚
â”‚   - ç›®æ ‡å‡½æ•°å®Œæ•´ä»£ç  (2KB)                                   â”‚
â”‚   - ä¸Šæ¸¸è°ƒç”¨è€…ä»£ç ç‰‡æ®µ (1KB)                                 â”‚
â”‚   - ä¸‹æ¸¸ä¾èµ–æ¥å£ (1KB)                                       â”‚
â”‚   - è°ƒç”¨é“¾è·¯å¾„ (0.5KB)                                       â”‚
â”‚   - å½±å“åˆ†æç»“æœ (0.5KB)                                     â”‚
â”‚                                                              â”‚
â”‚ æ€»è®¡: ~5KB                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 6: ä»£ç ä¿®æ”¹                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CodeGenerator.modify_existing_code()                        â”‚
â”‚ ğŸ¤– LLM è¾“å…¥ (~6KB):                                          â”‚
â”‚   - ä»»åŠ¡: "æ·»åŠ é‚®ç®±éªŒè¯æ­¥éª¤"                                  â”‚
â”‚   - ç²¾å‡†ä¸Šä¸‹æ–‡ (5KB)                                         â”‚
â”‚                                                              â”‚
â”‚ è¾“å‡º:                                                         â”‚
â”‚   - ä¿®æ”¹ register() æ·»åŠ éªŒè¯é€»è¾‘                             â”‚
â”‚   - æ›´æ–°è°ƒç”¨æ–¹ create_user()                                 â”‚
â”‚   - è¿ç§»æŒ‡å—                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ€» Token æ¶ˆè€—: ~14KB
```
## å››ã€LLM è°ƒç”¨ç‚¹æ±‡æ€»

### LLM API è°ƒç”¨ç»Ÿè®¡

| è°ƒç”¨ç‚¹ | æ¨¡å— | Token æ¶ˆè€— | é¢‘ç‡ | å¯ç¼“å­˜ |
|-------|------|-----------|------|--------|
| 1. éœ€æ±‚è§£æ | RequirementAnalyzer | ~2KB | æ¯éœ€æ±‚ 1 æ¬¡ | âœ… æ˜¯ |
| 2. åŠŸèƒ½è®¾è®¡ | RequirementAnalyzer | ~5KB | æ¯éœ€æ±‚ 1 æ¬¡ | âœ… æ˜¯ |
| 3. ä»»åŠ¡åˆ†è§£ | RequirementAnalyzer | ~3KB | æ¯éœ€æ±‚ 1 æ¬¡ | âœ… æ˜¯ |
| 4. ä»£ç ç”Ÿæˆ | CodeGenerator | ~4KB | æ¯ä»»åŠ¡ 1 æ¬¡ | âŒ å¦ |
| 5. ä»£ç ä¿®æ”¹ | CodeGenerator | ~6KB | æ¯ä»»åŠ¡ 1 æ¬¡ | âŒ å¦ |
| 6. æµ‹è¯•ç”Ÿæˆ | CodeGenerator | ~3KB | æ¯ä»»åŠ¡ 1 æ¬¡ | âŒ å¦ |
| 7. è¯­ä¹‰æŸ¥è¯¢ | CodebaseAgent | ~2KB | æŒ‰éœ€ | âš¡ éƒ¨åˆ† |

**æ€»è®¡**: æ¯ä¸ªå®Œæ•´éœ€æ±‚çº¦ **25-30KB** Token æ¶ˆè€—

### æ— éœ€ LLM çš„æ“ä½œ (IntentGraph ç›´æ¥æä¾›)

```python
# 1. è°ƒç”¨é“¾è¿½è¸ª (çº¯å›¾ç®—æ³•)
call_chain = agent.get_call_chain("register", direction="both", max_depth=3)

# 2. å½±å“åˆ†æ (åŸºäºä¾èµ–å›¾)
impact = agent.analyze_impact(target="register", change_type="signature_change")

# 3. æ¶æ„ç†è§£ (åŸºäºè¯­ä¹‰åˆ†æ)
architecture = agent.understand_architecture()

# 4. ç²¾å‡†å®šä½ (åŸºäºç¬¦å·ç´¢å¼•)
locations = agent.locate_implementation("user registration")

# 5. ç›¸ä¼¼æ¨¡å¼æŸ¥æ‰¾ (åŸºäºè¯­ä¹‰åˆ†æ)
patterns = agent.find_similar_patterns("authentication")

# 6. æ¨¡å—æ¥å£æå– (åŸºäºç¬¦å·åˆ†æ)
interfaces = agent.get_module_interfaces("User")
```

## äº”ã€ä¸Šä¸‹æ–‡ç²¾å‡†åº¦ä¼˜åŒ–

### 1. åˆ†å±‚ä¸Šä¸‹æ–‡åŠ è½½

```python
class ContextManager:
    def get_layered_context(self, target: str, token_budget: int) -> dict:
        """åˆ†å±‚åŠ è½½ä¸Šä¸‹æ–‡ï¼ŒæŒ‰éœ€æ‰©å±•"""

        # Layer 1: æ ¸å¿ƒä¸Šä¸‹æ–‡ (1KB) - å¿…éœ€
        context = {
            "target_code": self._get_target_code(target),
            "signature": self._get_signature(target),
            "line_range": self._get_line_range(target)
        }

        # Layer 2: ç›´æ¥ä¾èµ– (2KB) - é¢„ç®— > 2KB
        if token_budget > 2000:
            context["direct_dependencies"] = self._get_direct_deps(target)
            context["interface_contracts"] = self._get_interfaces(target)

        # Layer 3: è°ƒç”¨é“¾ (3KB) - é¢„ç®— > 5KB
        if token_budget > 5000:
            context["call_chain"] = self._get_call_chain(target, max_depth=2)
            context["impact_analysis"] = self._analyze_impact(target)

        # Layer 4: ç›¸ä¼¼æ¨¡å¼ (4KB) - é¢„ç®— > 8KB
        if token_budget > 8000:
            context["similar_patterns"] = self._find_similar(target, limit=3)
            context["usage_examples"] = self._get_usage_examples(target)

        return context
```

### 2. æ™ºèƒ½ä¸Šä¸‹æ–‡å‹ç¼©

```python
class ContextManager:
    def compress_context(self, context: dict, target_size: int) -> dict:
        """æ™ºèƒ½å‹ç¼©ä¸Šä¸‹æ–‡åˆ°ç›®æ ‡å¤§å°"""

        compressed = {}

        for key, value in context.items():
            if key == "target_code":
                # ç§»é™¤æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
                compressed[key] = self._remove_comments(value)

            elif key == "direct_dependencies":
                # åªä¿ç•™å‡½æ•°ç­¾åï¼Œä¸åŒ…å«å®ç°
                compressed[key] = [
                    {"name": dep["name"], "signature": dep["signature"]}
                    for dep in value
                ]

            elif key == "call_chain":
                # å‹ç¼©è°ƒç”¨é“¾ï¼Œåªä¿ç•™å…³é”®è·¯å¾„
                compressed[key] = self._compress_call_chain(value)

            elif key == "similar_patterns":
                # ä½¿ç”¨ç¬¦å·å¼•ç”¨ä»£æ›¿å®Œæ•´ä»£ç 
                compressed[key] = [
                    {"file": p["file"], "symbol": p["symbol"], "line": p["line"]}
                    for p in value
                ]

        return compressed
```

### 3. ä¸Šä¸‹æ–‡ç›¸å…³æ€§è¯„åˆ†

```python
class ContextManager:
    def rank_context_relevance(
        self,
        contexts: List[dict],
        task: str,
        target: str
    ) -> List[Tuple[dict, float]]:
        """å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œç›¸å…³æ€§æ’åº"""

        scores = []
        for ctx in contexts:
            # è¯­ä¹‰ç›¸ä¼¼åº¦ (50%)
            semantic_score = self._semantic_similarity(ctx, task)

            # ä¾èµ–å¼ºåº¦ (30%)
            dependency_score = self._dependency_strength(ctx, target)

            # ä»£ç è´¨é‡ (20%)
            quality_score = self._code_quality(ctx)

            total_score = (
                0.5 * semantic_score +
                0.3 * dependency_score +
                0.2 * quality_score
            )

            scores.append((ctx, total_score))

        # æŒ‰åˆ†æ•°é™åºæ’åº
        return sorted(scores, key=lambda x: x[1], reverse=True)
```

### 4. æ™ºèƒ½è¿‡æ»¤å’Œå»å™ª

```python
class ContextManager:
    def filter_and_denoise(
        self,
        results: List[dict],
        filters: dict
    ) -> List[dict]:
        """è¿‡æ»¤å’Œå»å™ªæœç´¢ç»“æœ"""

        filtered = results

        # è¿‡æ»¤æµ‹è¯•æ–‡ä»¶
        if filters.get("exclude_tests", True):
            filtered = [
                r for r in filtered
                if not r["file"].startswith("tests/")
            ]

        # ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡æ»¤
        if "min_similarity" in filters:
            filtered = [
                r for r in filtered
                if r.get("similarity", 0) >= filters["min_similarity"]
            ]

        # åŒå±‚è¿‡æ»¤ (åªä¿ç•™åŒä¸€æ¶æ„å±‚)
        if filters.get("same_layer_only", False):
            target_layer = self._get_layer(filters["target"])
            filtered = [
                r for r in filtered
                if self._get_layer(r["file"]) == target_layer
            ]

        # é™åˆ¶æ•°é‡
        if "limit" in filters:
            filtered = filtered[:filters["limit"]]

        return filtered
```
## å…­ã€æ ¸å¿ƒä¼˜åŠ¿

### 1. Token é«˜æ•ˆåˆ©ç”¨

| åœºæ™¯ | ä¼ ç»Ÿæ–¹å¼ | IntentGraph Agent | èŠ‚çœç‡ |
|------|---------|------------------|--------|
| ç†è§£æ•´ä½“æ¶æ„ | 50KB (å…¨éƒ¨ä»£ç ) | 5KB (æ¶æ„æ‘˜è¦) | **90%** |
| å®šä½åŠŸèƒ½å®ç° | 30KB (æœç´¢ç»“æœ) | 3KB (ç²¾å‡†å®šä½) | **90%** |
| è·å–è°ƒç”¨é“¾ | 20KB (æ‰‹åŠ¨è¿½è¸ª) | 2KB (è‡ªåŠ¨è¿½è¸ª) | **90%** |
| ä¿®æ”¹å­˜é‡ä»£ç  | 40KB (ç›¸å…³æ–‡ä»¶) | 4KB (ç²¾å‡†ä¸Šä¸‹æ–‡) | **90%** |

### 2. ä¸Šä¸‹æ–‡ç²¾å‡†åº¦

| åœºæ™¯ | æä¾›çš„ä¸Šä¸‹æ–‡ | ç²¾å‡†åº¦ | Token æ¶ˆè€— |
|------|------------|--------|-----------|
| æ–°å¢åŠŸèƒ½ | æ¶æ„æ‘˜è¦ + ç›¸ä¼¼æ¨¡å¼ + æ¥å£å®šä¹‰ | â­â­â­â­â­ 95% | ~5KB |
| ä¿®æ”¹å­˜é‡ä»£ç  | ç›®æ ‡ä»£ç  + è°ƒç”¨é“¾ + å½±å“åˆ†æ | â­â­â­â­â­ 98% | ~6KB |
| ç†è§£æ¶æ„ | åˆ†å±‚ç»“æ„ + æ¨¡å—å…³ç³» + è®¾è®¡æ¨¡å¼ | â­â­â­â­â­ 90% | ~3KB |
| å®šä½å®ç° | ç²¾å‡†æ–‡ä»¶ä½ç½® + å‡½æ•°ç­¾å | â­â­â­â­â­ 95% | ~2KB |

### 3. æ¶æ„ç†è§£èƒ½åŠ›

âœ… **ç²¾å‡†çš„åœ°æ–¹**:
- è°ƒç”¨é“¾è¿½è¸ªï¼ˆåŸºäºä¾èµ–å›¾ï¼Œ100% å‡†ç¡®ï¼‰
- å½±å“åˆ†æï¼ˆåŸºäºå›¾ç®—æ³•ï¼Œ95%+ å‡†ç¡®ï¼‰
- æ¥å£å®šä¹‰æå–ï¼ˆåŸºäºç¬¦å·åˆ†æï¼Œ100% å‡†ç¡®ï¼‰
- æ¶æ„ç†è§£ï¼ˆåŸºäºè¯­ä¹‰åˆ†æï¼Œ90%+ å‡†ç¡®ï¼‰

âš ï¸ **éœ€è¦ä¼˜åŒ–çš„åœ°æ–¹**:
- è¯­ä¹‰æŸ¥è¯¢çš„æ¨¡ç³ŠåŒ¹é…ï¼ˆéœ€è¦æ’åºå’Œè¿‡æ»¤ï¼‰
- ç›¸ä¼¼æ¨¡å¼çš„å™ªéŸ³è¿‡æ»¤ï¼ˆéœ€è¦ç›¸å…³æ€§è¯„åˆ†ï¼‰
- è°ƒç”¨é“¾æ·±åº¦æ§åˆ¶ï¼ˆéœ€è¦æ™ºèƒ½æˆªæ–­ï¼‰
- ä¸Šä¸‹æ–‡å¤§å°æ§åˆ¶ï¼ˆéœ€è¦åˆ†å±‚åŠ è½½ï¼‰

## ä¸ƒã€å®ç°è·¯çº¿å›¾

### Phase 1: å¢å¼º IntentGraph æ ¸å¿ƒèƒ½åŠ› (2-3 å‘¨)

**ç›®æ ‡**: æ‰©å±• CodebaseAgentï¼Œæ·»åŠ è°ƒç”¨é“¾è¿½è¸ªå’Œç²¾å‡†ä¸Šä¸‹æ–‡æå–

**ä»»åŠ¡**:
1. å®ç° `get_call_chain()` - åŸºäº function_dependencies æ„å»ºè°ƒç”¨å›¾
2. å®ç° `find_entry_points()` - æŸ¥æ‰¾æœ€ä¸Šæ¸¸è°ƒç”¨è€…
3. å®ç° `find_leaf_dependencies()` - æŸ¥æ‰¾æœ€ä¸‹æ¸¸ä¾èµ–
4. å®ç° `understand_architecture()` - åŸºäº file_purpose å’Œ design_patterns
5. å®ç° `get_module_boundaries()` - åŸºäº symbols å’Œ exports

**è¾“å‡º**:
- `src/intentgraph/ai/enhanced_agent.py`
- å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ä½¿ç”¨æ–‡æ¡£

### Phase 2: æ„å»ºä¸Šä¸‹æ–‡ç®¡ç†å™¨ (2-3 å‘¨)

**ç›®æ ‡**: å®ç°ç²¾å‡†ä¸Šä¸‹æ–‡æå–å’Œ Token ä¼˜åŒ–

**ä»»åŠ¡**:
1. å®ç° `trace_call_chain()` - è°ƒç”¨é“¾è¿½è¸ª
2. å®ç° `extract_precise_context()` - åˆ†å±‚ä¸Šä¸‹æ–‡åŠ è½½
3. å®ç° `analyze_impact()` - å½±å“åˆ†æå¼•æ“
4. å®ç° `compress_context()` - æ™ºèƒ½å‹ç¼©
5. å®ç° `rank_context_relevance()` - ç›¸å…³æ€§è¯„åˆ†
6. å®ç° `filter_and_denoise()` - æ™ºèƒ½è¿‡æ»¤

**è¾“å‡º**:
- `src/intentgraph/agent/context_manager.py`
- Token ä¼˜åŒ–ç®—æ³•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

### Phase 3: æ„å»ºéœ€æ±‚ç†è§£æ¨¡å— (3-4 å‘¨)

**ç›®æ ‡**: å®ç°éœ€æ±‚è§£æã€åŠŸèƒ½è®¾è®¡å’Œä»»åŠ¡åˆ†è§£

**ä»»åŠ¡**:
1. è®¾è®¡ LLM Prompt æ¨¡æ¿
2. å®ç° `analyze_requirement()` - éœ€æ±‚è§£æ
3. å®ç° `design_solution()` - åŠŸèƒ½è®¾è®¡ç”Ÿæˆ
4. å®ç° `decompose_tasks()` - ä»»åŠ¡åˆ†è§£
5. é›†æˆ OpenAI/Anthropic API
6. å®ç°ç»“æœç¼“å­˜æœºåˆ¶

**è¾“å‡º**:
- `src/intentgraph/agent/requirement_analyzer.py`
- Prompt æ¨¡æ¿åº“
- LLM é›†æˆé€‚é…å™¨

### Phase 4: æ„å»ºä»£ç ç”Ÿæˆæ¨¡å— (3-4 å‘¨)

**ç›®æ ‡**: å®ç°ä»£ç ç”Ÿæˆã€ä¿®æ”¹å’Œæµ‹è¯•ç”Ÿæˆ

**ä»»åŠ¡**:
1. å®ç° `implement_new_feature()` - æ–°åŠŸèƒ½ç”Ÿæˆ
2. å®ç° `modify_existing_code()` - å­˜é‡ä»£ç ä¿®æ”¹
3. å®ç° `generate_tests()` - æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
4. å®ç°ä»£ç é£æ ¼ä¿æŒæœºåˆ¶
5. å®ç°å‘åå…¼å®¹æ€§æ£€æŸ¥
6. å®ç°ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–å»ºè®®

**è¾“å‡º**:
- `src/intentgraph/agent/code_generator.py`
- ä»£ç ç”Ÿæˆ Prompt æ¨¡æ¿
- ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·

### Phase 5: é›†æˆå’Œä¼˜åŒ– (2-3 å‘¨)

**ç›®æ ‡**: ç«¯åˆ°ç«¯å·¥ä½œæµé›†æˆå’Œæ€§èƒ½ä¼˜åŒ–

**ä»»åŠ¡**:
1. å®ç°å®Œæ•´å·¥ä½œæµç¼–æ’
2. æ·»åŠ  CLI å‘½ä»¤æ”¯æŒ
3. æ€§èƒ½ä¼˜åŒ–å’Œ Token æ¶ˆè€—ä¼˜åŒ–
4. æ·»åŠ æ—¥å¿—å’Œç›‘æ§
5. ç¼–å†™å®Œæ•´æ–‡æ¡£
6. åˆ›å»ºç¤ºä¾‹é¡¹ç›®

**è¾“å‡º**:
- `src/intentgraph/agent/workflow.py`
- CLI å‘½ä»¤: `intentgraph agent`
- å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- ç¤ºä¾‹é¡¹ç›®å’Œæ•™ç¨‹

## å…«ã€æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–

```python
# å·²æœ‰ä¾èµ– (IntentGraph)
- typer: CLI æ¡†æ¶
- rich: ç»ˆç«¯è¾“å‡º
- networkx: å›¾ç®—æ³•
- pydantic: æ•°æ®éªŒè¯
- tree-sitter: ä»£ç è§£æ

# æ–°å¢ä¾èµ–
- openai: OpenAI API å®¢æˆ·ç«¯
- anthropic: Anthropic API å®¢æˆ·ç«¯
- tiktoken: Token è®¡æ•°
- jinja2: Prompt æ¨¡æ¿
- redis: ç»“æœç¼“å­˜ (å¯é€‰)
```

### é¡¹ç›®ç»“æ„

```
src/intentgraph/
â”œâ”€â”€ agent/                      # AI ç¼–ç  Agent (æ–°å¢)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ requirement_analyzer.py # éœ€æ±‚ç†è§£æ¨¡å—
â”‚   â”œâ”€â”€ context_manager.py      # ä¸Šä¸‹æ–‡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ code_generator.py       # ä»£ç ç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ workflow.py             # å·¥ä½œæµç¼–æ’
â”‚   â””â”€â”€ prompts/                # Prompt æ¨¡æ¿
â”‚       â”œâ”€â”€ requirement.jinja2
â”‚       â”œâ”€â”€ design.jinja2
â”‚       â”œâ”€â”€ implementation.jinja2
â”‚       â””â”€â”€ test.jinja2
â”œâ”€â”€ ai/                         # AI æ¥å£å±‚ (æ‰©å±•)
â”‚   â”œâ”€â”€ enhanced_agent.py       # å¢å¼ºçš„ CodebaseAgent
â”‚   â”œâ”€â”€ call_chain.py           # è°ƒç”¨é“¾è¿½è¸ª
â”‚   â”œâ”€â”€ impact_analyzer.py      # å½±å“åˆ†æ
â”‚   â””â”€â”€ architecture.py         # æ¶æ„ç†è§£
â””â”€â”€ cli.py                      # CLI (æ‰©å±•)
```

## ä¹ã€ä½¿ç”¨ç¤ºä¾‹

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# æ–°å¢åŠŸèƒ½
intentgraph agent new-feature \
  --requirement "æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œæ”¯æŒé‚®ç®±å’Œæ‰‹æœºå·ç™»å½•" \
  --repo /path/to/repo \
  --token-budget 30000

# ä¿®æ”¹å­˜é‡ä»£ç 
intentgraph agent modify \
  --requirement "ä¿®æ”¹ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼Œæ·»åŠ é‚®ç®±éªŒè¯æ­¥éª¤" \
  --target "User.register" \
  --repo /path/to/repo

# äº¤äº’å¼æ¨¡å¼
intentgraph agent interactive --repo /path/to/repo
```

### Python API ä½¿ç”¨

```python
from intentgraph.agent import CodingAgent

# åˆå§‹åŒ– Agent
agent = CodingAgent(
    repo_path="/path/to/repo",
    llm_provider="openai",  # or "anthropic"
    model="gpt-4",
    token_budget=30000
)

# æ–°å¢åŠŸèƒ½
result = agent.implement_feature(
    requirement="æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œæ”¯æŒé‚®ç®±å’Œæ‰‹æœºå·ç™»å½•"
)

print(f"ç”Ÿæˆçš„æ–‡ä»¶: {result.files}")
print(f"ä¿®æ”¹çš„æ–‡ä»¶: {result.modified_files}")
print(f"Token æ¶ˆè€—: {result.token_usage}")

# ä¿®æ”¹å­˜é‡ä»£ç 
result = agent.modify_code(
    requirement="ä¿®æ”¹ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼Œæ·»åŠ é‚®ç®±éªŒè¯æ­¥éª¤",
    target="User.register"
)

print(f"ä¿®æ”¹å†…å®¹: {result.changes}")
print(f"å½±å“èŒƒå›´: {result.impact}")
```

## åã€æ€»ç»“

æœ¬è®¾è®¡æ–¹æ¡ˆåŸºäº IntentGraph çš„å¼ºå¤§ä»£ç åˆ†æèƒ½åŠ›ï¼Œæ„å»ºäº†ä¸€ä¸ª Token é«˜æ•ˆã€ä¸Šä¸‹æ–‡ç²¾å‡†çš„ AI ç¼–ç  Agentã€‚

**æ ¸å¿ƒç‰¹ç‚¹**:
1. **Token é«˜æ•ˆ**: é€šè¿‡ç²¾å‡†ä¸Šä¸‹æ–‡æå–ï¼ŒèŠ‚çœ 90% Token æ¶ˆè€—
2. **ä¸Šä¸‹æ–‡ç²¾å‡†**: åŸºäºè°ƒç”¨é“¾å’Œä¾èµ–å›¾ï¼Œæä¾› 95%+ ç²¾å‡†åº¦
3. **æ¶æ„ç†è§£**: è‡ªåŠ¨ç†è§£ä»£ç åº“æ¶æ„å’Œæ¨¡å—è¾¹ç•Œ
4. **éœ€æ±‚è½¬æ¢**: è‡ªåŠ¨å°†éœ€æ±‚è½¬æ¢ä¸ºæŠ€æœ¯æ–¹æ¡ˆå’Œå¯æ‰§è¡Œä»»åŠ¡
5. **ä»£ç ç”Ÿæˆ**: ç”Ÿæˆç¬¦åˆç°æœ‰æ¶æ„å’Œä»£ç é£æ ¼çš„ä»£ç 

**é€‚ç”¨åœºæ™¯**:
- âœ… æ–°å¢åŠŸèƒ½å¼€å‘
- âœ… å­˜é‡ä»£ç ä¿®æ”¹
- âœ… ä»£ç é‡æ„
- âœ… Bug ä¿®å¤
- âœ… æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ

**é¢„æœŸæ•ˆæœ**:
- æ¯ä¸ªéœ€æ±‚ Token æ¶ˆè€—: 25-30KB (ä¼ ç»Ÿæ–¹å¼ 200KB+)
- ä¸Šä¸‹æ–‡ç²¾å‡†åº¦: 95%+
- ä»£ç ç”Ÿæˆè´¨é‡: ç¬¦åˆç°æœ‰æ¶æ„å’Œé£æ ¼
- å¼€å‘æ•ˆç‡æå‡: 3-5 å€